<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Kami Flex AI Image Generator</title>
  <style>
    body {
      background:#060818;
      color:#fff;
      font-family:'Poppins',sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      height:100vh;
      margin:0;
    }
    .card {
      background:rgba(255,255,255,0.05);
      padding:25px;
      border-radius:15px;
      box-shadow:0 0 20px rgba(0,255,255,0.2);
      text-align:center;
      width:90%;
      max-width:400px;
    }
    input,button {
      width:100%;
      padding:12px;
      border:none;
      border-radius:10px;
      margin-top:10px;
      font-size:15px;
    }
    input {background:rgba(255,255,255,0.1);color:#fff;}
    button {
      background:linear-gradient(90deg,#00eaff,#ff00d4);
      color:#000;font-weight:600;cursor:pointer;
    }
    #loader {display:none;margin-top:10px;}
    .spinner {
      border:5px solid rgba(255,255,255,0.1);
      border-top:5px solid #00eaff;
      border-radius:50%;
      width:40px;height:40px;
      animation:spin 1s linear infinite;
      margin:10px auto;
    }
    @keyframes spin {0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
    #result img {max-width:100%;border-radius:10px;margin-top:10px;}
    .download-btn{
      margin-top:8px;
      padding:8px 14px;
      border-radius:10px;
      background:linear-gradient(90deg,#00eaff,#ff007f);
      color:#000;
      font-weight:600;
      cursor:pointer;
      display:inline-block;
      text-decoration:none;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>‚ö° Kami Flex Image Generator ‚ö°</h2>
    <input type="text" id="prompt" placeholder="Type something... e.g. cat" />
    <button id="generateBtn">üé® Generate</button>
    <button onclick="window.open('https://t.me/Kami_Broken5','_blank')">üì¢ Join Telegram</button>
    <div id="loader"><div class="spinner"></div><p>Generating image...</p></div>
    <div id="result"></div>
    <p id="error" style="color:#ff5b5b;"></p>
  </div>

<script>
const btn = document.getElementById('generateBtn');
const loader = document.getElementById('loader');
const result = document.getElementById('result');
const error = document.getElementById('error');

btn.addEventListener('click', async () => {
  const text = document.getElementById('prompt').value.trim();
  if(!text){ error.textContent="‚ö†Ô∏è Please enter a prompt"; return; }

  loader.style.display="block"; result.innerHTML=""; error.textContent="";

  try {
    const res = await fetch(`/api/imggen?input=${encodeURIComponent(text)}`);
    if(!res.ok) throw new Error("API error");
    const data = await res.text();

    if(data.startsWith("http")){
      const img = document.createElement("img");
      img.src = data.trim();
      result.appendChild(img);

      // Download button
      const download = document.createElement("a");
      download.href = data.trim();
      download.download = "kami_ai_image.png";
      download.textContent = "‚¨áÔ∏è Download";
      download.className = "download-btn";
      result.appendChild(download);
    } else {
      error.textContent = "‚ö†Ô∏è No image found.";
    }
  } catch(err){
    error.textContent = "‚ö†Ô∏è Network or API error.";
  } finally {
    loader.style.display="none";
  }
});
</script>
</body>
</html>
